# Wukong 2.0 æ¶æ„æ¶ˆåŒ–

> **ä¸€å¥è¯æ€»ç»“**: ä» **"æœ¬ä½“è¯»æç¤ºè¯ â†’ æ‰‹åŠ¨å¬å”¤åˆ†èº«"** å‡çº§ä¸º **"Runtime ç¼–æ’ â†’ Subagents è‡ªåŠ¨è°ƒåº¦"**

---

## ä¸€ã€æ ¸å¿ƒå˜åŒ–ï¼ˆä¸€é¡µçº¸ï¼‰

| ç»´åº¦ | 1.8.1 | 2.0 |
|------|-------|-----|
| **å®šä½** | æç¤ºè¯æ¡†æ¶ | äº‹ä»¶é©±åŠ¨è¿è¡Œæ—¶ |
| **è½¨é“è¡¨è¾¾** | ç¡¬ç¼–ç æµç¨‹ (Feature/Fix/Refactor) | TaskGraph DAG æ¨¡æ¿ |
| **åˆ†èº«å®ç°** | æç¤ºè¯æ³¨å…¥ | Claude åŸç”Ÿ subagents |
| **çŠ¶æ€ç®¡ç†** | æ— ï¼ˆå¯¹è¯ä¸Šä¸‹æ–‡ï¼‰ | state.json æŒä¹…åŒ– |
| **äº‹ä»¶æœºåˆ¶** | æ—  | events.jsonl äº‹ä»¶æ€»çº¿ |
| **äº§ç‰©ç®¡ç†** | æ•£è½åœ¨å¯¹è¯ä¸­ | artifacts/ ç›®å½•å½’æ¡£ |
| **éªŒè¯ä½“ç³»** | æˆ’å®šæ…§æ£€æŸ¥ï¼ˆæ‰‹åŠ¨ï¼‰ | è¯æ®åˆ†çº§ + å¯æ‰§è¡ŒéªŒè¯å­å›¾ |
| **é”šç‚¹å­˜å‚¨** | ä¸´æ—¶ä¸Šä¸‹æ–‡ | anchors/ æŒä¹…åŒ–åº“ |
| **é…ç½®ä½ç½®** | ~/.claude/skills/*.md | .claude/ (Claude) + .wukong/ (è¿è¡Œæ—¶) |

---

## äºŒã€æ¶æ„å…¨æ™¯å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Wukong 2.0 Runtime                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ User Prompt â”‚â”€â”€â”€â–¶â”‚           Event Bus (äº‹ä»¶æ€»çº¿)               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  UserPromptSubmit â†’ SubagentStop â†’ Stop     â”‚    â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                        â”‚                                â”‚
â”‚                                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Scheduler (è°ƒåº¦å™¨)                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚   â”‚
â”‚  â”‚  â”‚ æ„å›¾åˆ†ç±»  â”‚â”€â”€â–¶â”‚ DAG é€‰æ‹©  â”‚â”€â”€â–¶â”‚ Node è°ƒåº¦ â”‚                     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚   â”‚
â”‚  â”‚       â”‚              â”‚               â”‚                           â”‚   â”‚
â”‚  â”‚       â–¼              â–¼               â–¼                           â”‚   â”‚
â”‚  â”‚  [anchorså¬å›]  [taskgraph.json]  [æˆæœ¬è·¯ç”±]                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚                                â”‚
â”‚                                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              å…­æ ¹ Subagents Pack (.claude/agents/)               â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚   â”‚ ğŸ‘ï¸çœ¼ â”‚  â”‚ ğŸ‘‚è€³ â”‚  â”‚ ğŸ‘ƒé¼» â”‚  â”‚ ğŸ‘…èˆŒ â”‚  â”‚ âš”ï¸èº«  â”‚  â”‚ ğŸ§ æ„ â”‚        â”‚   â”‚
â”‚  â”‚   â”‚CHEAPâ”‚  â”‚CHEAPâ”‚  â”‚CHEAPâ”‚  â”‚ MED â”‚  â”‚ EXP â”‚  â”‚ EXP â”‚        â”‚   â”‚
â”‚  â”‚   â”‚ BG  â”‚  â”‚ opt â”‚  â”‚ BG  â”‚  â”‚ opt â”‚  â”‚ FG  â”‚  â”‚ FG  â”‚        â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚                                â”‚
â”‚                                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Artifact Manager (äº§ç‰©ç®¡ç†)                    â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   .wukong/                                                       â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ taskgraph.json    (å½“å‰ä»»åŠ¡å›¾)                              â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ state.json        (è¿è¡ŒçŠ¶æ€)                                â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ events.jsonl      (äº‹ä»¶æ—¥å¿—)                                â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€ artifacts/        (åˆ†èº«äº§ç‰©)                                â”‚   â”‚
â”‚  â”‚   â””â”€â”€ anchors/          (æŒä¹…åŒ–é”šç‚¹)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€å››å¤§æ”¯æŸ±

```
â”Œâ”€ TaskGraph â”€â”€â”€â”€â”€â”€ DAG è¡¨è¾¾ä»»åŠ¡ï¼Œæ”¯æŒå¹¶è¡Œ/åˆ†å‰/å›æ»š
â”œâ”€ Runtime â”€â”€â”€â”€â”€â”€â”€â”€ äº‹ä»¶æ€»çº¿ + çŠ¶æ€æœº + è°ƒåº¦å™¨
â”œâ”€ Subagents Pack â”€ å…­æ ¹è½åœ°ä¸º .claude/agents/*.md
â””â”€ Verification â”€â”€â”€ è¯æ®åˆ†çº§ L0-L3 + å¯æ‰§è¡ŒéªŒè¯å­å›¾
```

---

## å››ã€å…³é”®æ¦‚å¿µé€ŸæŸ¥

| æ¦‚å¿µ | å®šä¹‰ | ä½ç½®/å®ç° |
|------|------|-----------|
| **TaskGraph** | DAG å½¢å¼çš„ä»»åŠ¡ç¼–æ’å›¾ | `.wukong/taskgraph.json` |
| **Node** | ä»»åŠ¡å›¾åŸºæœ¬å•å…ƒ | TaskGraph èŠ‚ç‚¹ |
| **Event Bus** | äº‹ä»¶é©±åŠ¨é€šä¿¡ | `.wukong/events.jsonl` |
| **Subagent** | Claude åŸç”Ÿå­ä»£ç† | `.claude/agents/` |
| **Artifact** | åˆ†èº«æ‰§è¡Œäº§ç‰© | `.wukong/artifacts/` |
| **Anchor** | æŒä¹…åŒ–å†³ç­–/çº¦æŸ | `.wukong/anchors/` |
| **Evidence Level** | éªŒè¯è¯æ®åˆ†çº§ | L0-L3 |

### Node Schema å…³é”®å­—æ®µ

```json
{
  "id": "unique-node-id",
  "title": "èŠ‚ç‚¹æ ‡é¢˜",
  "role": "çœ¼|è€³|é¼»|èˆŒ|èº«|æ„",
  "executor": "subagent åç§°",
  "inputs": {
    "files": ["æ–‡ä»¶è·¯å¾„"],
    "context_refs": ["ä¸Šä¸‹æ–‡å¼•ç”¨"],
    "upstream_outputs": ["ä¸Šæ¸¸èŠ‚ç‚¹ID"]
  },
  "constraints": {
    "allowed_tools": ["å·¥å…·ç™½åå•"],
    "time_budget": "æ—¶é—´é¢„ç®—"
  },
  "quality": {
    "evidence_level_required": "L0|L1|L2|L3",
    "checklist": ["éªŒè¯æ¸…å•"]
  },
  "status": "pending|running|done|failed|blocked",
  "outputs": {
    "artifacts": ["äº§ç‰©è·¯å¾„"],
    "summary": "æ‘˜è¦",
    "evidence": "è¯æ®"
  }
}
```

### äº‹ä»¶ç”Ÿå‘½å‘¨æœŸ

| äº‹ä»¶ | è§¦å‘æ—¶æœº | åŠ¨ä½œ |
|------|----------|------|
| `UserPromptSubmit` | ç”¨æˆ·è¾“å…¥æäº¤ | æ„å›¾åˆ†ç±» + anchor å¬å› + DAG é€‰æ‹© |
| `SubagentStop` | åˆ†èº«å®Œæˆ | å½’æ¡£äº§ç‰© + è§¦å‘ä¸‹æ¸¸èŠ‚ç‚¹ |
| `Stop` | ä»»åŠ¡å®Œæˆ | æ±‡æ€»äº§ç‰© + ç”Ÿæˆæ–° anchors |
| `PreCompact` | ä¸Šä¸‹æ–‡å‹ç¼©å‰ | æŠ½å–å…³é”®ä¿¡æ¯ + æ›´æ–°ç´¢å¼• |

---

## äº”ã€æˆ’å®šæ…§è¯†åœ¨ 2.0 çš„ä½ç½®

| æ¨¡å— | 1.x å®ç° | 2.0 å®ç° |
|------|----------|----------|
| **æˆ’** | æ‰‹åŠ¨æ£€æŸ¥è¾¹ç•Œ | Node.constraints + allowed_tools |
| **å®š** | è¯æ®åˆ†çº§å£å¤´çº¦å®š | Node.quality + éªŒè¯å­å›¾ |
| **æ…§** | PreCompact Hook | PreCompact Hook + anchor æŠ½å– |
| **è¯†** | ä¸´æ—¶ä¸Šä¸‹æ–‡ | artifacts/ + anchors/ æŒä¹…åŒ– |

---

## å…­ã€å®æ–½è·¯çº¿å›¾ï¼ˆæŒ‰é˜¶æ®µï¼‰

### Phase 0: æ•°æ®ç»“æ„ä¸ç›®å½•è½åœ°

**ç›®æ ‡**: å»ºç«‹ 2.0 çš„æ•°æ®åŸºç¡€è®¾æ–½

**äº¤ä»˜ç‰©**:
```
â–¡ .wukong/runtime/ ç›®å½•ç»“æ„
  â”œâ”€â”€ schema/
  â”‚   â”œâ”€â”€ taskgraph.schema.json   # TaskGraph JSON Schema
  â”‚   â”œâ”€â”€ node.schema.json        # Node å®šä¹‰
  â”‚   â””â”€â”€ event.schema.json       # Event å®šä¹‰
  â””â”€â”€ templates/
      â”œâ”€â”€ fix_track.json          # Fix è½¨é“ DAG æ¨¡æ¿
      â”œâ”€â”€ feature_track.json      # Feature è½¨é“ DAG æ¨¡æ¿
      â””â”€â”€ direct_track.json       # Direct è½¨é“ DAG æ¨¡æ¿

â–¡ .wukong/ è¿è¡Œæ—¶æ•°æ®ç›®å½•
  â”œâ”€â”€ taskgraph.json              # å½“å‰ä»»åŠ¡å›¾å®ä¾‹
  â”œâ”€â”€ state.json                  # è¿è¡ŒçŠ¶æ€
  â”œâ”€â”€ events.jsonl                # äº‹ä»¶æ—¥å¿—
  â””â”€â”€ artifacts/                  # äº§ç‰©å½’æ¡£ç›®å½•
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] Schema æ–‡ä»¶å¯é€šè¿‡ JSON Schema æ ¡éªŒå·¥å…·éªŒè¯
- [ ] æ¨¡æ¿æ–‡ä»¶ç¬¦åˆ Schema å®šä¹‰
- [ ] ç›®å½•ç»“æ„ä¸è®¾è®¡æ–‡æ¡£ä¸€è‡´

---

### Phase 1: å…­æ ¹ Subagents åŸç”ŸåŒ–

**ç›®æ ‡**: å°†å…­æ ¹åˆ†èº«è½åœ°ä¸º Claude åŸç”Ÿ subagents

**äº¤ä»˜ç‰©**:
```
â–¡ .claude/agents/
  â”œâ”€â”€ eye.md      # çœ¼åˆ†èº«: è§‚å¯Ÿ/æ¢ç´¢/æœç´¢
  â”œâ”€â”€ ear.md      # è€³åˆ†èº«: éœ€æ±‚/æ¾„æ¸…/ç†è§£
  â”œâ”€â”€ nose.md     # é¼»åˆ†èº«: å®¡è®¡/å®‰å…¨/è§„èŒƒ
  â”œâ”€â”€ tongue.md   # èˆŒåˆ†èº«: æµ‹è¯•/æ–‡æ¡£/å¤ç°
  â”œâ”€â”€ body.md     # èº«åˆ†èº«: å®ç°/ä¿®å¤/é‡æ„
  â””â”€â”€ mind.md     # æ„åˆ†èº«: æ¶æ„/ç­–ç•¥/å†³ç­–
```

**æ¯ä¸ª agent æ–‡ä»¶åŒ…å«**:
- YAML frontmatter (name, description, allowed_tools, model)
- èŒè´£æè¿° (responsibilities)
- è¾“å‡ºæ ¼å¼è§„èŒƒ (output_format)
- Do/Don't è¾¹ç•Œ

**éªŒæ”¶æ ‡å‡†**:
- [ ] 6 ä¸ª agent æ–‡ä»¶åˆ›å»ºå®Œæˆ
- [ ] æ¯ä¸ª agent æœ‰æ˜ç¡®çš„å·¥å…·ç™½åå•
- [ ] è¾“å‡ºæ ¼å¼ç»Ÿä¸€ (Summary/Steps/Evidence/Risks/Next)

---

### Phase 2: Runtime MVP (äº‹ä»¶é©±åŠ¨)

**ç›®æ ‡**: å®ç°æœ€å°å¯ç”¨çš„äº‹ä»¶é©±åŠ¨è¿è¡Œæ—¶

**äº¤ä»˜ç‰©**:
```
â–¡ .wukong/runtime/
  â”œâ”€â”€ event_bus.py        # äº‹ä»¶æ€»çº¿: å†™å…¥/è¯»å– events.jsonl
  â”œâ”€â”€ state_manager.py    # çŠ¶æ€ç®¡ç†: è¯»å†™ state.json
  â”œâ”€â”€ scheduler.py        # è°ƒåº¦å™¨: DAG è§£æ + èŠ‚ç‚¹è°ƒåº¦
  â””â”€â”€ artifact_manager.py # äº§ç‰©ç®¡ç†: å½’æ¡£åˆ†èº«è¾“å‡º
```

**æ ¸å¿ƒåŠŸèƒ½**:
- `write_event(type, payload)` - å†™å…¥äº‹ä»¶
- `get_state() / set_state()` - çŠ¶æ€è¯»å†™
- `get_ready_nodes()` - è·å–å¯æ‰§è¡ŒèŠ‚ç‚¹
- `schedule_node(node_id)` - è°ƒåº¦èŠ‚ç‚¹åˆ° subagent
- `archive_output(node_id, output)` - å½’æ¡£äº§ç‰©

**éªŒæ”¶æ ‡å‡†**:
- [ ] èƒ½åŠ è½½ TaskGraph æ¨¡æ¿å¹¶å®ä¾‹åŒ–
- [ ] èƒ½æŒ‰ DAG é¡ºåºè°ƒåº¦èŠ‚ç‚¹
- [ ] SubagentStop äº‹ä»¶èƒ½è§¦å‘ä¸‹æ¸¸èŠ‚ç‚¹
- [ ] äº§ç‰©æ­£ç¡®å½’æ¡£åˆ° artifacts/

---

### Phase 3: ç«¯åˆ°ç«¯é›†æˆ (Fix Track)

**ç›®æ ‡**: è·‘é€šä¸€æ¡å®Œæ•´çš„ Fix è½¨é“

**äº¤ä»˜ç‰©**:
```
â–¡ /wukong_fix å‘½ä»¤æ›´æ–°
  - ç”Ÿæˆ Fix DAG å®ä¾‹
  - å¯åŠ¨ Runtime è°ƒåº¦
  - æ”¶é›†å¹¶æ±‡æ€»ç»“æœ

â–¡ Fix Track DAG (æœ€å°ç‰ˆ):
  Eye (æ¢ç´¢) â†’ Body (å®ç°) â†’ Tongue (éªŒè¯)
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] `/wukong_fix "ä¿®å¤ xxx bug"` èƒ½ç”Ÿæˆ DAG
- [ ] Runtime èƒ½ä¾æ¬¡è°ƒåº¦ Eye â†’ Body â†’ Tongue
- [ ] æ¯ä¸ªèŠ‚ç‚¹äº§ç‰©æ­£ç¡®å½’æ¡£
- [ ] æœ€ç»ˆè¾“å‡ºåŒ…å« L2 çº§åˆ«è¯æ®

---

### Phase 4: éªŒè¯é—­ç¯ä¸ Anchors

**ç›®æ ‡**: å®Œå–„éªŒè¯ä½“ç³»å’Œè®°å¿†ç®¡ç†

**äº¤ä»˜ç‰©**:
```
â–¡ Evidence Skill
  â”œâ”€â”€ SKILL.md
  â””â”€â”€ templates/evidence_report.md

â–¡ Anchor ç®¡ç†
  â”œâ”€â”€ .wukong/anchors/anchors.md      # æ­£å¼é”šç‚¹åº“
  â”œâ”€â”€ .wukong/anchors/candidates.md   # å€™é€‰é”šç‚¹
  â””â”€â”€ .wukong/anchors/index.json      # ç´¢å¼•

â–¡ Hooks é›†æˆ
  â”œâ”€â”€ on_subagent_stop.py   # SubagentStop â†’ å½’æ¡£ + è§¦å‘ä¸‹æ¸¸
  â””â”€â”€ on_stop.py            # Stop â†’ æ±‡æ€» + ç”Ÿæˆ anchors
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ¯ä¸ªèŠ‚ç‚¹è¾“å‡ºç¬¦åˆ Evidence æ ¼å¼
- [ ] Stop æ—¶è‡ªåŠ¨ç”Ÿæˆ anchor å€™é€‰
- [ ] anchor å¬å›åŠŸèƒ½å¯ç”¨ (å…³é”®è¯åŒ¹é…)

---

### Phase 5: å®Œæ•´è½¨é“ä¸ä¼˜åŒ–

**ç›®æ ‡**: è¡¥é½æ‰€æœ‰è½¨é“ï¼Œä¼˜åŒ–ä½“éªŒ

**äº¤ä»˜ç‰©**:
```
â–¡ Feature Track DAG
  [Ear+Eye] â†’ [Mind] â†’ [Body] â†’ [Tongue+Nose]

â–¡ Refactor Track DAG
  [Eye] â†’ [Mind] â†’ [Body] â†’ [Nose+Tongue]

â–¡ /wukong_resume å‘½ä»¤
  - ä» state.json æ¢å¤ä¸­æ–­çš„ä»»åŠ¡

â–¡ å¯è§‚æµ‹æ€§å¢å¼º
  - æˆæœ¬ç»Ÿè®¡
  - è€—æ—¶ç»Ÿè®¡
  - å¤±è´¥é‡è¯•
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] 3 æ¡è½¨é“éƒ½èƒ½ç«¯åˆ°ç«¯è¿è¡Œ
- [ ] ä¸­æ–­åèƒ½æ¢å¤ç»§ç»­
- [ ] æœ‰åŸºæœ¬çš„æŒ‡æ ‡è¾“å‡º

---

## ä¸ƒã€ç›®å½•ç»“æ„

```
.claude/
  agents/           # å…­æ ¹ subagents (NEW)
    eye.md
    ear.md
    nose.md
    tongue.md
    body.md
    mind.md
  skills/           # èƒ½åŠ›åŒ…
  commands/         # å‘½ä»¤å…¥å£
  hooks/            # äº‹ä»¶é’©å­

.wukong/
  taskgraph.json    # å½“å‰ä»»åŠ¡å›¾ (NEW)
  state.json        # è¿è¡ŒçŠ¶æ€ (NEW)
  events.jsonl      # äº‹ä»¶æ—¥å¿— (NEW)
  artifacts/        # äº§ç‰©å½’æ¡£ (NEW)
  anchors/          # é”šç‚¹åº“
  context/          # ä¸Šä¸‹æ–‡å­˜æ¡£
  notepads/         # æ™ºæ…§è®°å½•
```

---

## å…«ã€å¼€æ”¾å†³ç­–ç‚¹

| é—®é¢˜ | é€‰é¡¹ | å»ºè®® |
|------|------|------|
| MVP èŒƒå›´ | æœ€å° (1 Track) vs å®Œæ•´ (3 Tracks) | **æœ€å° (Fix only)** |
| Subagent æ ¼å¼ | å¤ç”¨ .md vs æ–° JSON | **å¤ç”¨ .md + è–„å°è£…** |
| State æŒä¹…åŒ– | æ–‡ä»¶ vs SQLite | **æ–‡ä»¶ (ç®€å•å¯è°ƒè¯•)** |
| éªŒè¯å­å›¾ | MVP è·³è¿‡ vs ç®€å•å®ç° | **ä¿ç•™ç°æœ‰æˆ’å®šæ…§** |

---

## ä¹ã€ä¸ä¹‹å‰è®¨è®ºçš„èåˆ

### ä¹‹å‰æ„åˆ†èº«å»ºè®®çš„æ··åˆæ–¹æ¡ˆ

| æ··åˆæ–¹æ¡ˆåŸåˆ™ | 2.0 å®ç° |
|--------------|----------|
| ä¿ç•™æç¤ºè¯çµæ´»æ€§ | agents/*.md ä»æ˜¯ Markdown |
| æ¸è¿›å¼å‡çº§ | DAG æ¨¡æ¿å¯é€‰ï¼ŒDirect Track å…œåº• |
| è¯æ®é©±åŠ¨ | Node.quality.evidence_level_required |
| æˆæœ¬æ„ŸçŸ¥ | Cost Routing å†…ç½®åœ¨ Scheduler |
| ä¸Šä¸‹æ–‡æ•ˆç‡ | context_refs æ›¿ä»£å®Œæ•´å†å² |
| æŒä¹…åŒ–é”šç‚¹ | anchors/ ç›®å½• + PreCompact æŠ½å– |

---

*æ¶ˆåŒ–ç‰ˆæœ¬: v1.0 | åŸºäºè®¾è®¡æ–‡æ¡£ v0.9 | 2026-01-16*
