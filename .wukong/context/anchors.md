# 全局锚点索引 (Global Anchors Index)

> 锚点是不可压缩的关键信息，无论金箍棒如何缩小，锚点始终保留。

## 使用说明

1. 新建锚点时，在对应类型下添加
2. 使用 `[Dxxx]` 格式在任何地方引用
3. 定期清理过期锚点

---

## 决策锚点 [D]

### [D001] 六根分身模型选择
**时间**: 2025-01-12
**Context**: 需要设计多分身协作系统，实现 AI Agent 的任务分解与并行执行
**Decision**: 采用佛教六根（眼耳鼻舌身意）作为分身职能划分
**Evidence**:
- 六根天然对应感知-理解-决策-行动-表达-审查的完整认知链
- 眼(探索/搜索) → 耳(需求/理解) → 意(设计/决策) → 身(实现/行动) → 舌(测试/文档) → 鼻(审查/检测)
- 佛学概念易于记忆，具有内在一致性
**Impact**:
- 职责边界清晰，每个分身有明确的 Do/Don't
- 易于理解和扩展，新用户可快速上手
- 支持并行执行（筋斗云机制）
**Tags**: #architecture #identity #core

---

### [D002] 末那识作为横切能力
**时间**: 2025-01-12
**Context**: 分身输出可能包含假设、偏见、范围蔓延，需要机制检测和纠偏
**Decision**: 引入末那识（第七识）作为横切能力，而非流水线中的节点
**Evidence**:
- 佛学中末那识是"执着自我、产生偏见"的根源
- 将其定位为检测器而非生产者，符合其本质
- 横切设计允许在任意分身输出后触发，不增加流水线复杂度
**Impact**:
- 可随时扫描任意分身输出中的隐含假设
- 检测危险信号（"应该可以..."、"没有问题"等 L0 推测）
- 强制要求证据，防止乐观偏见
**Tags**: #architecture #verification #横切能力

---

### [D003] 戒定慧三关作为验证门禁
**时间**: 2025-01-12
**Context**: 需要多层验证机制确保分身输出质量，防止"声称完成实际未完成"
**Decision**: 采用佛教"戒定慧"三学作为验证三关
**Evidence**:
- 戒（Sila）= 规则检查：是否遵守 Output Contract、Do/Don't 边界
- 定（Samadhi）= 可复现检查：L2/L3 证据等级，构建/测试可运行
- 慧（Prajna）= 抽象沉淀：是否验证充分、是否可提取为锚点
- 三关递进，形成完整的质量门禁
**Impact**:
- 戒关防止违规输出，定关确保可复现，慧关沉淀知识
- 与末那识配合，形成"过滤 → 规则 → 复现 → 抽象 → 沉淀"完整链路
- 失败有明确处理路径（打回/补充/标记）
**Tags**: #architecture #verification #quality-gate

---

### [D004] 多文件修改必须并行召唤分身
**时间**: 2025-01-12
**Context**: 发现把三个独立文件修改任务打包给一个分身串行执行，效率损失约 2/3
**Decision**: 修改 ≥2 个独立文件时，必须并行召唤多个分身，每文件一个
**Evidence**:
- 本次改进三个文件 (anchors.md, requirements-analyst.md, verification.md) 被串行处理
- 并行执行可将时间从 ~3min 缩短到 ~1min
- 三个文件无依赖关系，完全可以并行
**Impact**:
- 多文件任务效率提升 2-3 倍
- 需要在召唤前增加自检步骤
**Tags**: #efficiency #parallelization #筋斗云

---

## 约束锚点 [C]

<!--
添加约束锚点示例:
## [C001] 所有输出必须脱敏
**时间**: 2024-01-15
**约束**: 代码审查结果返回前必须移除敏感信息
**原因**: 数据安全合规
-->

*暂无锚点*

---

## 接口锚点 [I]

<!--
添加接口锚点示例:
## [I001] Sanitizer.sanitize()
**时间**: 2024-01-15
**签名**: sanitize(data: Any) -> Any
**用途**: 递归脱敏数据结构
-->

*暂无锚点*

---

## 问题锚点 [P]

### [P001] 多独立任务打包给单分身 (反模式)
**时间**: 2025-01-12
**状态**: Resolved (已加入规则)
**症状**: 把修改多个独立文件的任务打包给一个斗战胜佛，导致串行执行
**根因**: 筋斗云协议缺少强制并行条件，未明确什么情况必须拆分
**解决**: 在核心规则中增加"强制并行条件"和"召唤前自检"
**预防**: 召唤分身前问自己"能拆成并行吗？"
**Tags**: #antipattern #parallelization

---

### [P002] 运行时数据误提交到仓库
**时间**: 2025-01-12
**状态**: Resolved (已加入 .gitignore)
**症状**: `.wukong/context/` 下的会话数据被 `git add -A` 提交到仓库
**根因**:
- .gitignore 未覆盖运行时数据目录
- 使用 `git add -A` 未检查暂存内容
**解决**:
- 更新 .gitignore 排除 context/current/, context/sessions/, index.json
- 使用 `git rm --cached` 从跟踪中移除
**预防**:
- 提交前检查 `git status` 是否包含运行时数据
- 新建目录时同步更新 .gitignore
**Tags**: #security #git #antipattern

---

## 用户偏好锚点 [U]

<!--
添加偏好锚点示例:
## [U001] 偏好简洁回复
**时间**: 2024-01-15
**偏好**: 回复尽量简短，不要过度解释
-->

*暂无锚点*

---

## 锚点统计

| 类型 | 数量 | 最新 |
|------|------|------|
| 决策 [D] | 4 | D004 |
| 约束 [C] | 0 | - |
| 接口 [I] | 0 | - |
| 问题 [P] | 2 | P002 |
| 偏好 [U] | 0 | - |

*最后更新: 2025-01-12*
